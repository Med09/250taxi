<div id="background_frame_register">

<style>
	.reg_check_img {
		width: 16px;
		margin-right: 5px;
		margin-bottom: 5px;
		vertical-align: middle;
	}

</style>

<script>
	function register() {

		check_name = "No";
		check_phone = "No";
		check_email = "No";

		first_name = document.getElementById("first_name").value;
		last_name = document.getElementById("last_name").value;
		phone = document.getElementById("phone").value;
		email = document.getElementById("email").value;

		var check_phone_is_number = isNaN(phone);

		if (check_phone_is_number == true || phone.length < 1) {
			phone = "Invalid";
			check_phone_img = "bad.png";
		} else {
			check_phone = "OK";
			check_phone_img = "ok.png";
		}

		if (first_name.length < 1 || last_name.length < 1) {
			first_name = "Invalid";
			check_name_img = "bad.png";
		} else {
			check_name = "OK";
			check_name_img = "ok.png";
		}


		function validateEmail(email) {
			var re = /\S+@\S+\.\S+/;
			return re.test(email);
		}

		var check_email_format = validateEmail(email);

		if (check_email_format == false || email.length < 1) {
			email = "Invalid";
			check_email_img = "bad.png";
		} else {
			check_email = "OK";
			check_email_img = "ok.png";
		}


		alert("<img width='16px' class='reg_check_img' src=reg/" + check_name_img + ">Name: " + first_name + " " + last_name + "<br><img width='16px' class='reg_check_img' src=reg/" + check_phone_img + ">Phone: " + phone + "<br><img width='16px' class='reg_check_img' src=reg/" + check_email_img + ">E-Mail: " + email + "");

		if (check_name == "OK" && check_email == "OK" && check_phone == "OK") {

			$.get("https://250taxi.com/db/check-email.php", {
				email: email
			}).done(function(data) {

				if (data == "false") {
					alert("Account is in use.");
				}
				if (data == "true") {
					
					username = first_name;
					username = username.toLowerCase();
					
					check_username();
				}

			});


		} else {
			return;
		}

	}
	function check_username() {
		
		console.log("check_username");
		
		
		
		$.get("https://250taxi.com/db/check-username.php", {
						username: username
					}).done(function(data) {

						if (data == "false") {
							
							username_random_number = Math.floor(Math.random() * 90 + 10);
							username = username + username_random_number;
							check_username();
						}
						if (data == "true") {
							console.log(username);
							gotopin();
						}


					});
		
	}

	function convert_uc_first_name() {
		var data_new = document.getElementById("first_name").value;
		var data_new_first = data_new.toUpperCase();
		var data_new_first = data_new_first.substring(0, 1);
		var data_new = data_new.substring(1);
		document.getElementById("first_name").value = data_new_first + data_new;
	}

	function convert_uc_last_name() {
		var data_new = document.getElementById("last_name").value;
		var data_new_first = data_new.toUpperCase();
		var data_new_first = data_new_first.substring(0, 1);
		var data_new = data_new.substring(1);
		document.getElementById("last_name").value = data_new_first + data_new;
	}


	function gotopin() {
		document.getElementById("reg_personal_details").style.display = "none";
		document.getElementById("reg_pin").style.display = "block";
	}

</script>



<img id="close_reg_start_arrow" onclick="close_reg_start();" class="ios_back_arrow" src="ios_icons/Icon-arrow-left.png">

<div id="reg_form">

	<div id="reg_personal_details" class="animated fadeIn">

		<input onblur="convert_uc_first_name();" placeholder="First name" id="first_name">
		<input onblur="convert_uc_last_name();" placeholder="Last name" id="last_name">
		<input placeholder="Phone" type="tel" id="phone">
		<input placeholder="E-Mail" type="email" id="email">

		<button onclick="register();">Next</button>

	</div>

	<div id="reg_pin" style="display:none;" class="animated fadeIn">

		<input type="tel" maxlength="4" placeholder="PIN" id="pin">
		
		<br>
		<input id="terms_checkbox" type="checkbox"> <span onclick="terms();" id="terms_text">I accept the terms & conditions.</span>

		<button onclick="check_pin_and_register();">Next</button>


	</div>
    
    <div id="reg_how_found" style="display:none;" class="animated fadeIn">

		<select id="reg_how_found_select">
        <option value="">How did you hear about us?</option>
        <option value="Social Media">Social Media</option>
        <option value="Google">Google</option>
        <option value="From a friend">From a friend</option>
        <option value="TV/Newspaper">TV/Newspaper</option>
        <option value="Flier">Flier</option>
        </select>
		
		<br>

		<button onclick="how_did_you_find_us_complete()">Complete</button>


	</div>
    
</div>

<script>
    function check_pin_and_register() {

		var pin = document.getElementById("pin").value;

		var pin_is_number = /^\d{4}$/.test(pin);

		if (pin_is_number == false) {
			document.getElementById("pin").value = "";
			alert("PIN format incorrect.<br>Please enter a 4-digit number.");
		} else {
			
			var terms_checkbox = $('#terms_checkbox:checked').val();
			
			if(terms_checkbox == "on") {
				showindicator();
				how_did_you_find_us();
			}
			else {
				alert("Please accept our<br>terms & conditions!");
			}
			
		}
	}


    function how_did_you_find_us() {
        
    hideindicator();
        
    document.getElementById("reg_how_found").style.display = "block";
    document.getElementById("reg_pin").style.display = "none";
    
    }
    
    function how_did_you_find_us_complete() {
    
    reg_how_found_select = document.getElementById("reg_how_found_select").value;
        
    if (reg_how_found_select == "") {
        alert("Please let us know how you heard about us.");
        return;
    }
        
    complete_registration();

    }

	$(document).ready(function() {
		$('#first_name').keyup(function() {
			this.value = this.value.replace(/ /g, "");
		});
		$('#last_name').keyup(function() {
			this.value = this.value.replace(/ /g, "");
		});
		$('#email').keyup(function() {
			this.value = this.value.toLowerCase();
			this.value = this.value.replace(/ /g, "");
		});
		$(function() {
			$('#first_name').keypress(function(e) {
				var txt = String.fromCharCode(e.which);
				console.log(txt + ' : ' + e.which);
				if (!txt.match(/[A-Za-z0-9]/)) //+#-.
				{
					return false;
				}
			});
		});
		$(function() {
			$('#last_name').keypress(function(e) {
				var txt = String.fromCharCode(e.which);
				console.log(txt + ' : ' + e.which);
				if (!txt.match(/[A-Za-z0-9]/)) //+#-.
				{
					return false;
				}
			});
		});
		$(function() {
			$('#email').keypress(function(e) {
				var txt = String.fromCharCode(e.which);
				console.log(txt + ' : ' + e.which);
				if (!txt.match(/[A-Za-z0-9@.]/)) //+#-.
				{
					return false;
				}
			});
		});
	});

</script>

<style>
	#pin {
		-webkit-text-security: circle;
		text-security: circle;
	}

</style>

</div>